%------------------------------------------------------------------------------
% Bishop's University thesis style, as changed by Stefan Bruda from:
% Queen's University thesis style, as changed by Bob Burke from:
% Stanford University PhD thesis style -- modifications to the report style
%------------------------------------------------------------------------------

\typeout{Document Style Option `buthesis' <17 November 2015>.}

\long\def\comment#1{}
\comment{

Example of use:

    \documentclass[11pt,oneside]{book}
    \usepackage{buthesis}

    \begin{document}
    \title{How to Write Theses\\
        With Two Line Titles}
    \author{John Henry Candidate}
 
    \beforepreface
    \prefacesection{Preface}
        This thesis tells you all you need to know about...
    \prefacesection{Acknowledgments}
        I would like to thank...
    \afterpreface
 
    \chapter{Introduction}
         ...
    \chapter{Conclusions}
         ...
    \bibliographystyle{plain}
    \bibliography{mybib}
         ...
    \appendix
    \chapter{A Long Proof}
        ...
    \vita
       Brief CV goes here.
    \end{document}


    Documentation:

    This style file modifies the standard report or book styles to
    follow the School of Bishop's University's "General Form of
    Thesis."  It sets the margins and interline spacing and disallows
    page breaks at hyphens.

    The \beforepreface command creates the title page.  Then the user
    should put preface section(s), using the command:

        \prefacesection{section title}

    The \afterpreface command then produces the tables of contents,
    tables and figures, and sets things up to start the main body (on
    arabic page 1).

    The following commands can control what goes in the front matter
    material:

    \title{thesis title}
    \author{author's name}
    \dept{author's department}
        - Computer Science if omitted
    \degree{degree expected}
        - Master of Science if omitted
    \submitdate{month year in which the final version is submitted for binding}
        - date LaTeX'd if omitted
    \copyrightyear{year degree conferred}
        - year LaTeX'd if omitted
    \figurespagetrue or \figurespagefalse
        - produce or don't produce a List of Figures page
          (true by default)
    \tablespagetrue or \tablespagefalse
        - produce or don't produce a List of Tables page
          (true by default)

    This style uses double spacing, except in the figure and table
    environments where normal spacing is used.  That can be changed by
    doing:

    \renewcommand{\baselinestretch}{1.6}

    (or whatever you want instead of 1.6).  The example above shows
    the 11pt substyle being used.  }

% First thing we do is make sure that report has been loaded.  A
% common error is to try to use buthesis as a documentstyle.
\@ifundefined{chapter}{\@latexerr{The `buthesis' option should be used
with the `report' or `book' document styles}{You should probably read the
buthesis documentation.}}{}

\RequirePackage{hyperref}

% We need 1" margins except on the binding edge, where it is 1 1/2"
% Theses are single-sided, so we don't care about \evensidemargin
\oddsidemargin 0.5in \evensidemargin 0in
\marginparwidth 40pt \marginparsep 10pt
\topmargin 0pt \headsep .5in
\textheight 8.1in \textwidth 6in

% Disallow page breaks at hyphens (this will give some underfull vbox's,
% so an alternative is to use \brokenpenalty=100 and manually search
% for and fix such page breaks)
\brokenpenalty=10000

%---Set up double spacing (code taken from setspace.sty)
%% *** Change and comment out ***
%\ifcase \@ptsize \relax % 10pt
%    \def\baselinestretch{1.667}
%  \or % 11pt
%    \def\baselinestretch{1.618}
%  \or % 12pt
%    \def\baselinestretch{1.655}
%  \fi

\newlength{\singlebaselineskip}
\newlength{\doublebaselineskip}
\setlength{\singlebaselineskip}{\baselineskip}
\setlength{\doublebaselineskip}{1.6\baselineskip}

\newcommand{\singlespacing}{\setlength{\baselineskip}{\singlebaselineskip}}
\newcommand{\doublespacing}{\setlength{\baselineskip}{1.6\baselineskip}}

\newcommand{\adjustsingle}{\vspace*{-\singlebaselineskip}}
%\newcommand{\adjustsingle}{}

% Redefine the macro used for floats (including figures and tables)
% so that single spacing is used.
% (Note \def\figure{\@float{figure}set single spacing} doesn't work
% because figure has an optional argument)
%\def\@xfloat#1[#2]{\ifhmode \@bsphack\@floatpenalty -\@Mii\else
%   \@floatpenalty-\@Miii\fi\def\@captype{#1}\ifinner
%      \@parmoderr\@floatpenalty\z@
%    \else\@next\@currbox\@freelist{\@tempcnta\csname ftype@#1\endcsname
%       \multiply\@tempcnta\@xxxii\advance\@tempcnta\sixt@@n
%       \@tfor \@tempa :=#2\do
%                        {\if\@tempa h\advance\@tempcnta \@ne\fi
%                         \if\@tempa t\advance\@tempcnta \tw@\fi
%                         \if\@tempa b\advance\@tempcnta 4\relax\fi
%                         \if\@tempa p\advance\@tempcnta 8\relax\fi
%         }\global\count\@currbox\@tempcnta}\@fltovf\fi
%    \global\setbox\@currbox\vbox\bgroup 
%    \def\baselinestretch{1}\@normalsize
%    \boxmaxdepth\z@
%    \hsize\columnwidth \@parboxrestore}

% Redefine the macro used for footnotes to use single spacing
\long\def\@footnotetext#1{\insert\footins{\def\baselinestretch{1}\footnotesize
    \interlinepenalty\interfootnotelinepenalty 
    \splittopskip\footnotesep
    \splitmaxdepth \dp\strutbox \floatingpenalty \@MM
    \hsize\columnwidth \@parboxrestore
   \edef\@currentlabel{\csname p@footnote\endcsname\@thefnmark}\@makefntext
    {\rule{\z@}{\footnotesep}\ignorespaces
      #1\strut}}}

% \author, \title, \dept, \degree are defined in report;
% here are the rest of the front matter defining macros
\def\dept#1{\gdef\@dept{#1}}
\def\degree#1{\gdef\@degree{#1}}
\def\submitdate#1{\gdef\@submitdate{#1}}
\def\copyrightyear#1{\gdef\@copyrightyear{#1}} % \author, \title in report
\def\@title{}\def\@author{}
\def\@dept{Department of Computer Science}
\def\@degree{Master of Science}
\def\@submitdate{\ifcase\the\month\or
  January\or February\or March\or April\or May\or June\or
  July\or August\or September\or October\or November\or December\fi
  \space \number\the\year}
\def\@copyrightyear{\number\the\year}
\newif\iffigurespage \newif\iftablespage
\figurespagetrue \tablespagetrue


\def\titlep{%
    \thispagestyle{empty}%
    \doublespacing%
    \begin{center}
      \vfill

        {\Large\sc\@title}\\
        \mbox{}\\
        \mbox{}\\
        by\\
        \mbox{}\\
        \mbox{}\\
        {\large\sc\@author}\\
    \end{center}
    \mbox{}
    \begin{center}
        A thesis submitted to the\\
        \@dept\\
        in conformity with the requirements for\\
        the degree of \@degree\\
    \end{center}
    \mbox{}
    \begin{center}
        Bishop's University\\
        Sherbrooke, Quebec, Canada\\
        \@submitdate\\
    \end{center}
    % \mbox{}
    \vfill 
    \begin{center}
        Copyright \copyright\ \@author, \@copyrightyear
    \end{center}\clearpage}

\def\beforepreface{
    \titlep
    \pagenumbering{roman}
    \pagestyle{plain}}

\def\prefacesection#1{%
    \chapter*{#1}}

\def\afterpreface{\clearpage
    \tableofcontents
    \clearpage
    \iftablespage
        \listoftables
        \clearpage
    \fi
    \iffigurespage
        \listoffigures
        \clearpage
    \fi
    \pagenumbering{arabic}
    \pagestyle{headings}}

%\renewcommand{\appendix}{}

\def\vita{%
  \chapter*{Vita}
  \markboth{VITA.}{VITA.}}

% Redefine \thebibliography to go to a new page and put an entry in the
% table of contents
\let\@ldthebibliography\thebibliography
\renewcommand{\thebibliography}[1]{\clearpage
    \addcontentsline{toc}{chapter}{Bibliography}
    \@ldthebibliography{#1}}

% Start out normal
\pagestyle{headings}
